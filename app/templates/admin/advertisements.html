{% extends "base.html" %}

{% block title %}åºƒå‘Šç®¡ç† - Night-Walk{% endblock %}

{% block content %}
<div class="admin-layout">
    {% include "admin/_sidebar.html" %}
    
    <div class="admin-content">
        <div class="d-flex justify-between align-center mb-4">
            <h1 class="mb-0">åºƒå‘Šç®¡ç†</h1>
            <a href="{{ url_for('admin.new_advertisement') }}" class="btn btn-primary">
                + æ–°è¦åºƒå‘Š
            </a>
        </div>
        
        <div class="card">
            {% if advertisements %}
            <table class="table">
                <thead>
                    <tr>
                        <th style="width: 80px;">ç”»åƒ</th>
                        <th>ã‚¿ã‚¤ãƒˆãƒ«</th>
                        <th>ä½ç½®</th>
                        <th>å„ªå…ˆåº¦</th>
                        <th>çŠ¶æ…‹</th>
                        <th>ã‚¯ãƒªãƒƒã‚¯æ•°</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in advertisements %}
                    <tr>
                        <td>
                            {% if item.display_image_url %}
                            <img src="{{ item.display_image_url }}" alt="" style="width: 60px; height: 40px; object-fit: cover; border-radius: var(--radius-sm);">
                            {% else %}
                            <div style="width: 60px; height: 40px; background: var(--color-bg-elevated); border-radius: var(--radius-sm); display: flex; align-items: center; justify-content: center; font-size: 0.75rem; color: var(--color-text-muted);">
                                ãªã—
                            </div>
                            {% endif %}
                        </td>
                        <td>
                            <strong>{{ item.title }}</strong>
                            {% if item.link_url %}
                            <br><span class="text-muted" style="font-size: 0.75rem;">ğŸ”— {{ item.link_url[:30] }}...</span>
                            {% endif %}
                        </td>
                        <td>
                            <span class="badge badge-info">{{ position_labels.get(item.position, item.position) }}</span>
                        </td>
                        <td>{{ item.priority }}</td>
                        <td>
                            {% if item.is_currently_active %}
                            <span class="badge badge-success">è¡¨ç¤ºä¸­</span>
                            {% elif item.is_active %}
                            <span class="badge badge-warning">äºˆç´„ä¸­</span>
                            {% else %}
                            <span class="badge" style="background: var(--color-bg-elevated);">éè¡¨ç¤º</span>
                            {% endif %}
                        </td>
                        <td>{{ item.click_count or 0 }}</td>
                        <td>
                            <div class="d-flex gap-1">
                                <a href="{{ url_for('admin.edit_advertisement', id=item.id) }}" class="btn btn-sm btn-secondary">
                                    ç·¨é›†
                                </a>
                                <form method="POST" action="{{ url_for('admin.delete_advertisement', id=item.id) }}"
                                      onsubmit="return confirm('ã“ã®åºƒå‘Šã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')">
                                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                                    <button type="submit" class="btn btn-sm btn-danger">å‰Šé™¤</button>
                                </form>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <p class="text-muted text-center">ã¾ã åºƒå‘ŠãŒã‚ã‚Šã¾ã›ã‚“</p>
            {% endif %}
        </div>
        
        <div class="card mt-4">
            <h3 class="mb-3">åºƒå‘Šä½ç½®ã«ã¤ã„ã¦</h3>
            <table class="table" style="margin: 0;">
                <tr>
                    <td><span class="badge badge-info">ãƒˆãƒƒãƒ—ãƒãƒŠãƒ¼</span></td>
                    <td>ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ä¸Šéƒ¨ã®ãƒ¡ã‚¤ãƒ³ãƒãƒŠãƒ¼ï¼ˆã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼å½¢å¼ï¼‰</td>
                </tr>
                <tr>
                    <td><span class="badge badge-info">ã‚µã‚¤ãƒ‰ãƒãƒ¼</span></td>
                    <td>æ¤œç´¢çµæœãƒšãƒ¼ã‚¸ã®ã‚µã‚¤ãƒ‰ãƒãƒ¼</td>
                </tr>
                <tr>
                    <td><span class="badge badge-info">ãƒšãƒ¼ã‚¸ä¸‹éƒ¨</span></td>
                    <td>å„ãƒšãƒ¼ã‚¸ã®ä¸‹éƒ¨</td>
                </tr>
                <tr>
                    <td><span class="badge badge-info">ä¸€è¦§å†…åºƒå‘Š</span></td>
                    <td>åº—èˆ—ä¸€è¦§ã®ä¸­ã«æŒ¿å…¥ã•ã‚Œã‚‹åºƒå‘Š</td>
                </tr>
            </table>
        </div>
    </div>
</div>
{% endblock %}
