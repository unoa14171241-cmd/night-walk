{% extends "base.html" %}

{% block title %}ãƒ¡ãƒ¼ãƒ«ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç·¨é›† - {{ template.name }} - Night-Walk{% endblock %}

{% block content %}
<div class="admin-layout">
    {% include "admin/_sidebar.html" %}

    <div class="admin-content">
        <div class="page-header">
            <h2>ğŸ“§ {{ template.name }} ã‚’ç·¨é›†</h2>
            <a href="{{ url_for('admin.email_templates') }}" class="btn btn-secondary btn-sm">â† ä¸€è¦§ã«æˆ»ã‚‹</a>
        </div>

        {% if placeholders %}
        <div class="card mb-4">
            <div class="card-header">
                <h3 class="card-title">ä½¿ç”¨å¯èƒ½ãªãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼</h3>
            </div>
            <div style="padding: 1rem;">
                <p class="text-muted" style="margin-bottom: 0.5rem; font-size: 0.85rem;">
                    ä»¥ä¸‹ã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã‚’ä»¶åãƒ»æœ¬æ–‡å†…ã«è¨˜è¼‰ã™ã‚‹ã¨ã€é€ä¿¡æ™‚ã«è‡ªå‹•ã§ç½®æ›ã•ã‚Œã¾ã™ã€‚
                </p>
                <div style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
                    {% for key, desc in placeholders.items() %}
                    <span
                        style="background: rgba(255,215,0,0.15); border: 1px solid var(--color-border); border-radius: 4px; padding: 4px 10px; font-size: 0.85rem;">
                        <code style="color: var(--color-primary);">{{ key }}</code> = {{ desc }}
                    </span>
                    {% endfor %}
                </div>
            </div>
        </div>
        {% endif %}

        <form method="POST" action="{{ url_for('admin.edit_email_template', template_id=template.id) }}">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

            <div class="card mb-4">
                <div class="card-header">
                    <h3 class="card-title">ä»¶å</h3>
                </div>
                <div style="padding: 1rem;">
                    <input type="text" name="subject" class="form-control" value="{{ template.subject }}" required
                        placeholder="ä¾‹: ã€Night-Walkã€‘åº—èˆ—æ²è¼‰å¯©æŸ»å®Œäº†ã®ãŠçŸ¥ã‚‰ã› - {shop_name}">
                    <small class="form-text"
                        style="color: var(--color-text-muted); margin-top: 0.5rem; display: block;">
                        ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã‚’å«ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ˆä¾‹: {shop_name}ï¼‰
                    </small>
                </div>
            </div>

            <div class="card mb-4">
                <div class="card-header">
                    <h3 class="card-title">æœ¬æ–‡ï¼ˆHTMLï¼‰</h3>
                </div>
                <div style="padding: 1rem;">
                    <textarea name="body_html" class="form-control" rows="25" required
                        style="font-family: monospace; font-size: 0.85rem; line-height: 1.5;">{{ template.body_html }}</textarea>
                    <small class="form-text"
                        style="color: var(--color-text-muted); margin-top: 0.5rem; display: block;">
                        HTMLã‚¿ã‚°ãŒä½¿ç”¨ã§ãã¾ã™ã€‚ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã¯è‡ªå‹•ã§ç½®æ›ã•ã‚Œã¾ã™ã€‚
                    </small>
                </div>
            </div>

            <div style="display: flex; gap: 1rem; align-items: center;">
                <button type="submit" class="btn btn-primary btn-lg">
                    ğŸ’¾ ä¿å­˜ã™ã‚‹
                </button>
                <a href="{{ url_for('admin.preview_email_template', template_id=template.id) }}" class="btn btn-outline"
                    target="_blank">
                    ğŸ‘ï¸ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
                </a>
            </div>
        </form>
    </div>
</div>
{% endblock %}