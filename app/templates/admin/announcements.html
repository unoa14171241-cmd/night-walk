{% extends "base.html" %}

{% block title %}ãŠçŸ¥ã‚‰ã›ç®¡ç† - Night-Walk{% endblock %}

{% block content %}
<div class="admin-layout">
    {% include "admin/_sidebar.html" %}
    
    <div class="admin-content">
        <div class="d-flex justify-between align-center mb-4">
            <h1 class="mb-0">ãŠçŸ¥ã‚‰ã›ç®¡ç†</h1>
            <a href="{{ url_for('admin.new_announcement') }}" class="btn btn-primary">
                + æ–°è¦ãŠçŸ¥ã‚‰ã›
            </a>
        </div>
        
        <div class="card">
            {% if announcements %}
            <table class="table">
                <thead>
                    <tr>
                        <th>ã‚¿ã‚¤ãƒˆãƒ«</th>
                        <th>å„ªå…ˆåº¦</th>
                        <th>çŠ¶æ…‹</th>
                        <th>æœŸé–“</th>
                        <th>ä½œæˆæ—¥</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in announcements %}
                    <tr>
                        <td>
                            <strong>{{ item.title }}</strong>
                            {% if item.link_url %}
                            <br><span class="text-muted" style="font-size: 0.75rem;">ğŸ”— ãƒªãƒ³ã‚¯ã‚ã‚Š</span>
                            {% endif %}
                        </td>
                        <td>{{ item.priority }}</td>
                        <td>
                            {% if item.is_currently_active %}
                            <span class="badge badge-success">è¡¨ç¤ºä¸­</span>
                            {% elif item.is_active %}
                            <span class="badge badge-warning">äºˆç´„ä¸­</span>
                            {% else %}
                            <span class="badge" style="background: var(--color-bg-elevated);">éè¡¨ç¤º</span>
                            {% endif %}
                        </td>
                        <td style="font-size: 0.75rem;">
                            {% if item.starts_at %}
                            {{ item.starts_at.strftime('%Y/%m/%d %H:%M') }}ã€œ
                            {% else %}
                            âˆ’
                            {% endif %}
                            {% if item.ends_at %}
                            <br>{{ item.ends_at.strftime('%Y/%m/%d %H:%M') }}
                            {% endif %}
                        </td>
                        <td style="font-size: 0.75rem;">
                            {{ item.created_at.strftime('%Y/%m/%d') }}
                        </td>
                        <td>
                            <div class="d-flex gap-1">
                                <a href="{{ url_for('admin.edit_announcement', id=item.id) }}" class="btn btn-sm btn-secondary">
                                    ç·¨é›†
                                </a>
                                <form method="POST" action="{{ url_for('admin.delete_announcement', id=item.id) }}"
                                      onsubmit="return confirm('ã“ã®ãŠçŸ¥ã‚‰ã›ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')">
                                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                                    <button type="submit" class="btn btn-sm btn-danger">å‰Šé™¤</button>
                                </form>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <p class="text-muted text-center">ã¾ã ãŠçŸ¥ã‚‰ã›ãŒã‚ã‚Šã¾ã›ã‚“</p>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
