{% extends "customer/base.html" %}

{% block title %}èªè¨¼ã‚³ãƒ¼ãƒ‰å…¥åŠ› - {{ shop.name }} - Night-Walk{% endblock %}

{% block content %}
<div class="container">
    <div class="row justify-content-center">
        <div class="col-lg-5">
            <div class="card">
                <div class="card-header">
                    <h4 class="mb-0">SMSèªè¨¼</h4>
                </div>
                <div class="card-body">
                    <!-- åº—èˆ—æƒ…å ± -->
                    <div class="shop-info mb-4 p-3 bg-dark rounded">
                        <h5 class="mb-1">{{ shop.name }}</h5>
                        <small class="text-muted">{{ shop.area }} / {{ shop.category_label }}</small>
                    </div>
                    
                    <div class="text-center mb-4">
                        <div class="sms-icon mb-3">ğŸ“±</div>
                        <p class="mb-0">SMSã«é€ä¿¡ã•ã‚ŒãŸ<br><strong>6æ¡ã®èªè¨¼ã‚³ãƒ¼ãƒ‰</strong>ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</p>
                    </div>
                    
                    <form method="POST" id="verifyForm">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                        
                        <div class="mb-4">
                            <input type="text" class="form-control form-control-lg text-center verification-code-input" 
                                   name="verification_code" id="verification_code"
                                   placeholder="000000" maxlength="6" pattern="[0-9]{6}"
                                   inputmode="numeric" autocomplete="one-time-code" required>
                            <small class="text-muted d-block text-center mt-2">
                                æœ‰åŠ¹æœŸé™: 10åˆ†é–“
                            </small>
                        </div>
                        
                        <div class="d-grid gap-2">
                            <button type="submit" class="btn btn-primary btn-lg">
                                èªè¨¼ã—ã¦æŠ•ç¨¿å®Œäº†
                            </button>
                        </div>
                    </form>
                    
                    <hr class="my-4">
                    
                    <div class="text-center">
                        <p class="text-muted mb-2">èªè¨¼ã‚³ãƒ¼ãƒ‰ãŒå±Šã‹ãªã„å ´åˆ</p>
                        <form method="POST" action="{{ url_for('customer.resend_review_code', shop_id=shop.id) }}">
                            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                            <button type="submit" class="btn btn-outline-secondary btn-sm">
                                èªè¨¼ã‚³ãƒ¼ãƒ‰ã‚’å†é€ä¿¡
                            </button>
                        </form>
                    </div>
                </div>
            </div>
            
            <!-- æ³¨æ„äº‹é … -->
            <div class="alert alert-info mt-3">
                <small>
                    <strong>ğŸ’¡ ãƒ’ãƒ³ãƒˆ:</strong>
                    SMSãŒå±Šã‹ãªã„å ´åˆã¯ã€é›»è©±ç•ªå·ãŒæ­£ã—ã„ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚
                    è¿·æƒ‘ãƒ¡ãƒ¼ãƒ«ãƒ•ã‚£ãƒ«ã‚¿ã®è¨­å®šã‚‚ã”ç¢ºèªãã ã•ã„ã€‚
                </small>
            </div>
        </div>
    </div>
</div>

<style>
.sms-icon {
    font-size: 3rem;
}

.verification-code-input {
    font-size: 2rem;
    letter-spacing: 0.5rem;
    font-family: monospace;
    font-weight: bold;
}

.verification-code-input::placeholder {
    color: var(--color-text-muted);
    opacity: 0.5;
}
</style>

<script>
// æ•°å­—ã®ã¿å…¥åŠ›å¯
document.getElementById('verification_code').addEventListener('input', function(e) {
    this.value = this.value.replace(/[^0-9]/g, '');
    
    // 6æ¡å…¥åŠ›ã§è‡ªå‹•é€ä¿¡
    if (this.value.length === 6) {
        // å°‘ã—é…å»¶ã•ã›ã¦UXå‘ä¸Š
        setTimeout(() => {
            if (confirm('èªè¨¼ã‚³ãƒ¼ãƒ‰ã‚’é€ä¿¡ã—ã¾ã™ã‹ï¼Ÿ')) {
                document.getElementById('verifyForm').submit();
            }
        }, 300);
    }
});
</script>
{% endblock %}
